language: java

dist: trusty

jobs:
  include:
    - stage: Build using various JDK versions
      jdk: oraclejdk8
    - jdk: oraclejdk9
    - jdk: openjdk8
    - stage: Test Coverage
      jdk: oraclejdk8
      after_success: mvn clean test jacoco:report coveralls:report
    - stage: Deploy
      if: branch = develop
      jdk: oraclejdk8
      before_script:
        - openssl aes-256-cbc -K $KEY -iv $IV -S $SALT -in .travis/gpg.enc -out .travis/gpg.asc -d
        - gpg2 --fast-import .travis/gpg.asc
      script: mvn deploy -B --settings=.travis/settings.xml -DskipTests=true
      on:
        branch: develop
